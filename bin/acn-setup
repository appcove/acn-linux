#!/usr/bin/python3
# vim:encoding=utf-8:ts=2:sw=2:expandtab

from acnpython32 import *

from collections import OrderedDict

CDEF = [
  ('1',     'acn-command', 'acn-setup-etcgit',       'Setup /etc with git'       ),
  ('2',     'acn-command', 'acn-setup-root',         'Configure root user'       ),
  ('3',     'acn-command', 'acn-setup-timezone',     'Set timzone'               ),
  ('4',     'acn-command', 'acn-setup-hostname',     'Set hostname'              ),
  ('5',     'acn-command', 'acn-setup-iptables',     'Build a firewall'          ),
  ('6',     'acn-command', 'acn-setup-user',         'Add/update a user'         ),
  ('7',     'acn-command', 'acn-setup-sshd',         'Lock down sshd'            ),
  ('8',     'acn-command', 'acn-setup-vim',          'Install custom vimrc'      ),
  ('9',     'acn-command', 'acn-setup-git',          'Install custom gitconfig'  ),
  ('10',    'acn-command', 'acn-setup-deploy',       'Build deploy user'         ),
  ('11',    'acn-command', 'acn-setup-nginx',        'Install/setup nginx'       ),
  ('12',    'acn-command', 'acn-setup-postgres',     'Install/setup postgresql'  ),
  ('exit',  'exit',        'quit the program',       'acn-setup-etcgit'          ),
  ]

ADEF = {
  'quit'  : 'exit',
  }



###############################################################################
CommandMap = OrderedDict()
for r in CDEF:
  CommandMap[r[0]] = r[1:]

AliasMap = OrderedDict(((r[0],r[0]) for r in CDEF))
AliasMap.update(ADEF)



try:
  while True:
    print()
    print('Available Commands: ')
    i = 0
    for command, data in CommandMap.items():
      print("  {0:6s} {1}".format(command, data[2]))
    
    print()
    command = CommandMap[
      AliasMap[
        GetInput_Choices('Enter Command: ', Choices=AliasMap.keys(), PrintChoices=False)
        ]
      ]
  
    if command[0] == 'acn-command':
      try:
        cmd = join(Path, 'bin', command[1])
        print()
        print("CALLING {0}".format(cmd))
        print()
        call((cmd))
      except KeyboardInterrupt:
        pass
    
    elif command[0] == 'exit':
      print()
      sys.exit(0)
    
    else:
      print("Unknown command type: '{0}'".format(command_type))

  print()


#except Exception as e:
#  print()
#  print()
#  print('*** Fatal Error ***')
#  print(e)
#  print()
except KeyboardInterrupt:
  print()  
  print()
  print('*** User Abort ***')
  print()

